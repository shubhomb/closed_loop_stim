2026-01-06 13:57:23,994 INFO: Logging started. Output file: rnn_training/20260106_135723/console.log
2026-01-06 13:57:23,995 INFO: Seed: 42
2026-01-06 13:57:23,995 INFO: Number of epochs 30
2026-01-06 13:57:24,174 INFO: Target neurons: [31]
2026-01-06 13:57:24,174 INFO: Target indices in filtered data: [30]
2026-01-06 13:57:24,175 INFO: configs shape: (3, 110, 31)
2026-01-06 13:57:24,175 INFO: roi_used shape: (512, 512)
2026-01-06 13:57:24,176 INFO: times shape: (3, 8, 31)
2026-01-06 13:57:24,177 INFO: dfof shape: (3, 15600, 110)
2026-01-06 13:57:26,333 INFO: Creating trials DataFrame with STIM_OFFSET=0 (stim at frame 0 of each snippet)
2026-01-06 13:57:26,335 INFO: Total trials before filtering: 744
2026-01-06 13:57:26,336 INFO: Final trials_df size: 744
2026-01-06 13:57:26,337 INFO: DataFrame shape: (744, 9)
2026-01-06 13:57:26,338 INFO: Trials per session: {0: 248, 1: 248, 2: 248}
2026-01-06 13:57:26,338 INFO: Unique values:
2026-01-06 13:57:26,339 INFO:   Sessions: 0, 1, 2
2026-01-06 13:57:26,339 INFO:   Configs: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31
2026-01-06 13:57:26,340 INFO:   Electrodes: -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9
2026-01-06 13:57:26,341 INFO:   Currents: 0, 3, 4, 5
2026-01-06 13:57:26,341 INFO: --- Filter Status ---
2026-01-06 13:57:26,341 INFO:   FILTER_CONFIGS: All
2026-01-06 13:57:26,342 INFO:   FILTER_NEURONS: All
2026-01-06 13:57:26,342 INFO:   FILTER_ELECTRODES: All
2026-01-06 13:57:26,343 INFO:   FILTER_CURRENTS: All
2026-01-06 13:57:26,344 INFO: trials_df head:
   session  trial  config  electrode  current  trial_start_time  stim_time  \
0        0      0       1          0        3              2811       2811   
1        0      1       1          0        3              3807       3807   
2        0      2       1          0        3              4181       4181   
3        0      3       1          0        3              6609       6609   
4        0      4       1          0        3              8787       8787   
5        0      5       1          0        3             11589      11589   
6        0      6       1          0        3             12647      12647   
7        0      7       1          0        3             12772      12772   
8        0      0       2          0        4              1130       1130   
9        0      1       2          0        4              6173       6173   

   start_time  is_stim  
0        2811     True  
1        3807     True  
2        4181     True  
3        6609     True  
4        8787     True  
5       11589     True  
6       12647     True  
7       12772     True  
8        1130     True  
9        6173     True  
2026-01-06 13:57:26,344 INFO: --- Example queries ---
2026-01-06 13:57:26,345 INFO: Electrode 9, Current 5: 24 trials
2026-01-06 13:57:26,346 INFO: Session 0, Config 7: 8 trials
2026-01-06 13:57:30,400 INFO: Initial conds shape: (915, 110)
2026-01-06 13:57:30,400 INFO: Activity snippets shape: (915, 50, 110)
2026-01-06 13:57:30,400 INFO: Stim snippets shape: (915, 50, 10)
2026-01-06 13:57:30,401 INFO: Snippet overlap: False
2026-01-06 13:57:31,638 INFO: Snippets DataFrame shape: (744, 18)
2026-01-06 13:57:31,639 INFO: Valid snippets: 744
2026-01-06 13:57:31,639 INFO: Snippets with stim at t=0: 744
2026-01-06 13:57:31,642 INFO: Holdout stim times per session: {np.int64(0): 62, np.int64(1): 62, np.int64(2): 62}
2026-01-06 13:57:31,657 INFO: Trial holdout [1, 7]: train=387, val=69, test=288
2026-01-06 13:57:31,658 INFO: === Split Summary (trial) ===
2026-01-06 13:57:31,658 INFO: Train: 387 samples (52.0%)
2026-01-06 13:57:31,659 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-06 13:57:31,659 INFO: Val: 69 samples (9.3%)
2026-01-06 13:57:31,659 INFO: Test: 288 samples (38.7%)
2026-01-06 13:57:31,660 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-06 13:58:18,809 INFO: Snippets DataFrame shape: (744, 18)
2026-01-06 13:58:18,809 INFO: Valid snippets: 744
2026-01-06 13:58:18,810 INFO: Snippets with stim at t=0: 744
2026-01-06 13:58:18,812 INFO: Holdout stim times per session: {np.int64(0): 31, np.int64(1): 31, np.int64(2): 31}
2026-01-06 13:58:18,827 INFO: Trial holdout [7]: train=522, val=93, test=129
2026-01-06 13:58:18,828 INFO: === Split Summary (trial) ===
2026-01-06 13:58:18,828 INFO: Train: 522 samples (70.2%)
2026-01-06 13:58:18,829 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-06 13:58:18,829 INFO: Val: 93 samples (12.5%)
2026-01-06 13:58:18,830 INFO: Test: 129 samples (17.3%)
2026-01-06 13:58:18,830 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-06 13:58:23,599 INFO: Batch size: 1
2026-01-06 13:58:23,600 INFO: Split strategy: trial
2026-01-06 13:58:23,615 INFO: Dataset sizes -> train: 522, val: 93, test: 129
2026-01-06 13:58:23,615 INFO: Target neurons: [31] (indices: [30])
2026-01-06 13:58:23,620 INFO: Model architecture:
RNNModel(
  (initial_state_projection): Linear(in_features=110, out_features=32, bias=True)
  (rnn): GRU(10, 32, batch_first=True)
  (dense): Sequential(
    (0): Linear(in_features=32, out_features=1, bias=True)
  )
)
2026-01-06 13:58:23,620 INFO: Train input size: 10
2026-01-06 13:58:23,621 INFO: Initial condition size: 110 (FILTER_NEURONS)
2026-01-06 13:58:23,621 INFO: Train output size: 1 (TARGET_NEURONS)
2026-01-06 13:58:23,622 INFO: Hidden state size: 32
2026-01-06 13:58:23,622 INFO: Number of GRU layers: 1
2026-01-06 13:58:24,277 INFO: Learning rate 0.001
2026-01-06 13:58:24,277 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    decoupled_weight_decay: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)
2026-01-06 13:58:24,277 INFO: Loss type: mse
2026-01-06 13:58:24,278 INFO: Regularization coefficient: 0
2026-01-06 13:58:53,201 INFO: Batch size: 4
2026-01-06 13:58:53,201 INFO: Split strategy: trial
2026-01-06 13:58:53,216 INFO: Dataset sizes -> train: 522, val: 93, test: 129
2026-01-06 13:58:53,216 INFO: Target neurons: [31] (indices: [30])
2026-01-06 13:58:53,220 INFO: Model architecture:
RNNModel(
  (initial_state_projection): Linear(in_features=110, out_features=32, bias=True)
  (rnn): GRU(10, 32, batch_first=True)
  (dense): Sequential(
    (0): Linear(in_features=32, out_features=1, bias=True)
  )
)
2026-01-06 13:58:53,220 INFO: Train input size: 10
2026-01-06 13:58:53,221 INFO: Initial condition size: 110 (FILTER_NEURONS)
2026-01-06 13:58:53,221 INFO: Train output size: 1 (TARGET_NEURONS)
2026-01-06 13:58:53,222 INFO: Hidden state size: 32
2026-01-06 13:58:53,222 INFO: Number of GRU layers: 1
2026-01-06 13:58:53,223 INFO: Learning rate 0.001
2026-01-06 13:58:53,223 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    decoupled_weight_decay: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)
2026-01-06 13:58:53,224 INFO: Loss type: mse
2026-01-06 13:58:53,224 INFO: Regularization coefficient: 0
