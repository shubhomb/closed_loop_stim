2026-01-06 11:32:05,357 INFO: Logging started. Output file: rnn_training/20260106_113202/console.log
2026-01-06 11:32:05,357 INFO: Seed: 42
2026-01-06 11:32:06,091 INFO: Initial conds shape: (915, 1)
2026-01-06 11:32:06,091 INFO: Activity snippets shape: (915, 50, 1)
2026-01-06 11:32:06,091 INFO: Stim snippets shape: (915, 50, 10)
2026-01-06 11:32:06,092 INFO: Snippet overlap: False
2026-01-06 11:32:07,597 INFO: Snippets DataFrame shape: (24, 18)
2026-01-06 11:32:07,598 INFO: Valid snippets: 24
2026-01-06 11:32:07,598 INFO: Snippets with stim at t=0: 24
2026-01-06 11:32:07,600 INFO: Holdout stim times per session: {np.int64(0): 1, np.int64(1): 1, np.int64(2): 1}
2026-01-06 11:32:07,602 INFO: Trial holdout [7]: train=17, val=4, test=3
2026-01-06 11:32:07,602 INFO: === Split Summary (trial) ===
2026-01-06 11:32:07,603 INFO: Train: 17 samples (70.8%)
2026-01-06 11:32:07,604 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-06 11:32:07,604 INFO: Val: 4 samples (16.7%)
2026-01-06 11:32:07,605 INFO: Test: 3 samples (12.5%)
2026-01-06 11:32:07,606 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-06 11:32:09,408 INFO: Batch size: 1
2026-01-06 11:32:09,408 INFO: Split strategy: trial
2026-01-06 11:32:09,411 INFO: Dataset sizes -> train: 17, val: 4, test: 3
2026-01-06 11:32:09,415 INFO: Model architecture:
RNNModel(
  (initial_state_projection): Linear(in_features=1, out_features=32, bias=True)
  (rnn): GRU(10, 32, batch_first=True)
  (dense): Sequential(
    (0): Linear(in_features=32, out_features=1, bias=True)
  )
)
2026-01-06 11:32:09,415 INFO: Train input size: 10
2026-01-06 11:32:09,415 INFO: Train output size: 1
2026-01-06 11:32:09,416 INFO: Hidden state size: 1
2026-01-06 11:32:09,416 INFO: Number of GRU layers: 1
2026-01-06 11:32:09,417 INFO: Learning rate 0.001
2026-01-06 11:32:09,418 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    decoupled_weight_decay: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)
2026-01-06 11:32:09,418 INFO: Loss type: mse
2026-01-06 11:32:09,419 INFO: Regularization coefficient: 0
2026-01-06 11:32:14,959 INFO: Epoch 1 Train loss: 0.031331048730541676
2026-01-06 11:32:15,006 INFO: Epoch 1 Validation loss: 0.020342277828603983
2026-01-06 11:32:15,012 INFO:   Saved best model with val loss 0.020342 to rnn_training/20260106_113202/best_model.pth
2026-01-06 11:32:17,537 INFO: Epoch 2 Train loss: 0.024152082171948516
2026-01-06 11:32:17,585 INFO: Epoch 2 Validation loss: 0.022576936287805438
2026-01-06 11:32:20,010 INFO: Epoch 3 Train loss: 0.021572996314395878
2026-01-06 11:32:20,055 INFO: Epoch 3 Validation loss: 0.01814705494325608
2026-01-06 11:32:20,059 INFO:   Saved best model with val loss 0.018147 to rnn_training/20260106_113202/best_model.pth
2026-01-06 11:32:22,591 INFO: Epoch 4 Train loss: 0.02174012510872939
2026-01-06 11:32:22,638 INFO: Epoch 4 Validation loss: 0.019087119260802865
2026-01-06 11:32:25,160 INFO: Epoch 5 Train loss: 0.020897444008904344
2026-01-06 11:32:25,204 INFO: Epoch 5 Validation loss: 0.01862366101704538
2026-01-06 11:32:27,676 INFO: Epoch 6 Train loss: 0.020097642753492382
2026-01-06 11:32:27,721 INFO: Epoch 6 Validation loss: 0.01836386462673545
2026-01-06 11:32:30,590 INFO: Epoch 7 Train loss: 0.019178259843850836
2026-01-06 11:32:30,631 INFO: Epoch 7 Validation loss: 0.018632963066920638
2026-01-06 11:32:33,325 INFO: Epoch 8 Train loss: 0.018418420927927774
2026-01-06 11:32:33,375 INFO: Epoch 8 Validation loss: 0.019550122786313295
2026-01-06 11:32:36,381 INFO: Epoch 9 Train loss: 0.01884346575859715
2026-01-06 11:32:36,426 INFO: Epoch 9 Validation loss: 0.017152493121102452
2026-01-06 11:32:36,430 INFO:   Saved best model with val loss 0.017152 to rnn_training/20260106_113202/best_model.pth
2026-01-06 11:32:39,273 INFO: Epoch 10 Train loss: 0.01784983742982149
2026-01-06 11:32:39,383 INFO: Epoch 10 Validation loss: 0.01878259563818574
2026-01-06 11:32:41,817 INFO: Epoch 11 Train loss: 0.01789521606748595
2026-01-06 11:32:41,863 INFO: Epoch 11 Validation loss: 0.017279190593399107
2026-01-06 11:32:44,413 INFO: Epoch 12 Train loss: 0.019002976662972394
2026-01-06 11:32:44,459 INFO: Epoch 12 Validation loss: 0.02057089190930128
2026-01-06 11:32:46,955 INFO: Epoch 13 Train loss: 0.017974252429078606
2026-01-06 11:32:47,002 INFO: Epoch 13 Validation loss: 0.017848906572908163
2026-01-06 11:32:49,444 INFO: Epoch 14 Train loss: 0.019199468441964948
2026-01-06 11:32:49,489 INFO: Epoch 14 Validation loss: 0.016994633595459163
2026-01-06 11:32:49,493 INFO:   Saved best model with val loss 0.016995 to rnn_training/20260106_113202/best_model.pth
2026-01-06 11:32:52,043 INFO: Epoch 15 Train loss: 0.017008800114340642
2026-01-06 11:32:52,089 INFO: Epoch 15 Validation loss: 0.022226839791983366
2026-01-06 11:32:54,483 INFO: Epoch 16 Train loss: 0.017773954088197035
2026-01-06 11:32:54,530 INFO: Epoch 16 Validation loss: 0.019585031317546964
2026-01-06 11:32:56,907 INFO: Epoch 17 Train loss: 0.01755632153328727
2026-01-06 11:32:56,953 INFO: Epoch 17 Validation loss: 0.018502683378756046
2026-01-06 11:32:59,489 INFO: Epoch 18 Train loss: 0.016842043273808324
2026-01-06 11:32:59,534 INFO: Epoch 18 Validation loss: 0.018316670786589384
2026-01-06 11:33:02,039 INFO: Epoch 19 Train loss: 0.01629097595372621
2026-01-06 11:33:02,085 INFO: Epoch 19 Validation loss: 0.018351713428273797
2026-01-06 11:33:04,481 INFO: Epoch 20 Train loss: 0.015888325185241067
2026-01-06 11:33:04,525 INFO: Epoch 20 Validation loss: 0.01704674691427499
2026-01-06 11:33:07,012 INFO: Epoch 21 Train loss: 0.015827459255781245
2026-01-06 11:33:07,057 INFO: Epoch 21 Validation loss: 0.019852673402056098
2026-01-06 11:33:09,480 INFO: Epoch 22 Train loss: 0.01447926987619961
2026-01-06 11:33:09,525 INFO: Epoch 22 Validation loss: 0.019582335487939417
2026-01-06 11:33:12,042 INFO: Epoch 23 Train loss: 0.01399958402137546
2026-01-06 11:33:12,087 INFO: Epoch 23 Validation loss: 0.01892182743176818
2026-01-06 11:33:14,770 INFO: Epoch 24 Train loss: 0.013208302724010804
2026-01-06 11:33:14,815 INFO: Epoch 24 Validation loss: 0.020979016670025885
2026-01-06 11:33:17,317 INFO: Epoch 25 Train loss: 0.012948909637463443
2026-01-06 11:33:17,363 INFO: Epoch 25 Validation loss: 0.023153552203439176
2026-01-06 11:33:19,842 INFO: Epoch 26 Train loss: 0.012925275847973192
2026-01-06 11:33:19,888 INFO: Epoch 26 Validation loss: 0.02189848688431084
2026-01-06 11:33:22,400 INFO: Epoch 27 Train loss: 0.01211178211002227
2026-01-06 11:33:22,445 INFO: Epoch 27 Validation loss: 0.021396595751866698
2026-01-06 11:33:24,954 INFO: Epoch 28 Train loss: 0.012496784986818539
2026-01-06 11:33:25,000 INFO: Epoch 28 Validation loss: 0.021487162332050502
2026-01-06 11:33:27,652 INFO: Epoch 29 Train loss: 0.012016589856049156
2026-01-06 11:33:27,697 INFO: Epoch 29 Validation loss: 0.02342110069002956
2026-01-06 11:33:30,265 INFO: Epoch 30 Train loss: 0.012829601257929908
2026-01-06 11:33:30,310 INFO: Epoch 30 Validation loss: 0.023653530166484416
2026-01-06 11:34:23,035 INFO: Test Loss: 0.014576
2026-01-06 11:34:34,796 INFO: Config 27 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 11:34:53,924 INFO: Number of epochs 30
2026-01-06 11:34:54,112 INFO: Filtered to 1 neurons: [31]
2026-01-06 11:34:54,112 INFO: New dfof shape: (3, 15600, 1)
2026-01-06 11:34:54,112 INFO: configs shape: (3, 110, 31)
2026-01-06 11:34:54,113 INFO: roi_used shape: (512, 512)
2026-01-06 11:34:54,114 INFO: times shape: (3, 8, 31)
2026-01-06 11:34:54,114 INFO: dfof shape: (3, 15600, 1)
2026-01-06 11:34:56,073 INFO: Total trials before filtering: 744
2026-01-06 11:34:56,074 INFO: Filtered to configs [27]: 24 trials remaining
2026-01-06 11:34:56,074 INFO: Final trials_df size: 24
2026-01-06 11:34:56,075 INFO: DataFrame shape: (24, 8)
2026-01-06 11:34:56,076 INFO: Trials per session: {0: 8, 1: 8, 2: 8}
2026-01-06 11:34:56,077 INFO: Unique values:
2026-01-06 11:34:56,077 INFO:   Sessions: 0, 1, 2
2026-01-06 11:34:56,078 INFO:   Configs: 27
2026-01-06 11:34:56,078 INFO:   Electrodes: 8
2026-01-06 11:34:56,078 INFO:   Currents: 5
2026-01-06 11:34:56,078 INFO: --- Filter Status ---
2026-01-06 11:34:56,079 INFO:   FILTER_CONFIGS: [27]
2026-01-06 11:34:56,079 INFO:   FILTER_NEURONS: [31]
2026-01-06 11:34:56,079 INFO:   FILTER_ELECTRODES: All
2026-01-06 11:34:56,079 INFO:   FILTER_CURRENTS: All
2026-01-06 11:34:56,082 INFO: trials_df head:
     session  trial  config  electrode  current  stim_time  start_time  \
208        0      0      27          8        5       1939        1949   
209        0      1      27          8        5       3371        3381   
210        0      2      27          8        5       3496        3506   
211        0      3      27          8        5       6546        6556   
212        0      4      27          8        5       8476        8486   
213        0      5      27          8        5      10282       10292   
214        0      6      27          8        5      13394       13404   
215        0      7      27          8        5      14017       14027   
456        1      0      27          8        5       1939        1949   
457        1      1      27          8        5       3371        3381   

     is_stim  
208     True  
209     True  
210     True  
211     True  
212     True  
213     True  
214     True  
215     True  
456     True  
457     True  
2026-01-06 11:34:56,083 INFO: --- Example queries ---
2026-01-06 11:34:56,083 INFO: Electrode 9, Current 5: 0 trials
2026-01-06 11:34:56,084 INFO: Session 0, Config 7: 0 trials
