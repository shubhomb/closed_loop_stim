2026-01-06 17:30:27,735 INFO: Logging started. Output file: rnn_training/20260106_173027/console.log
2026-01-06 17:30:27,735 INFO: Seed: 42
2026-01-06 17:30:27,736 INFO: Number of epochs 30
2026-01-06 17:30:27,930 INFO: Target neurons: [31]
2026-01-06 17:30:27,931 INFO: Target indices in filtered data: [30]
2026-01-06 17:30:27,932 INFO: configs shape: (3, 110, 31)
2026-01-06 17:30:27,932 INFO: roi_used shape: (512, 512)
2026-01-06 17:30:27,933 INFO: times shape: (3, 8, 31)
2026-01-06 17:30:27,934 INFO: dfof shape: (3, 15600, 110)
2026-01-06 17:30:28,030 INFO: Creating trials DataFrame with STIM_OFFSET=0 (stim at frame 0 of each snippet)
2026-01-06 17:30:28,030 INFO: Creating trials DataFrame with STIM_DELAY=0 (stim at frame 0 of each snippet)
2026-01-06 17:30:28,034 INFO: Total trials before filtering: 744
2026-01-06 17:30:28,035 INFO: Final trials_df size: 744
2026-01-06 17:30:28,035 INFO: DataFrame shape: (744, 9)
2026-01-06 17:30:28,037 INFO: Trials per session: {0: 248, 1: 248, 2: 248}
2026-01-06 17:30:28,038 INFO: Unique values:
2026-01-06 17:30:28,038 INFO:   Sessions: 0, 1, 2
2026-01-06 17:30:28,038 INFO:   Configs: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31
2026-01-06 17:30:28,039 INFO:   Electrodes: -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9
2026-01-06 17:30:28,040 INFO:   Currents: 0, 3, 4, 5
2026-01-06 17:30:28,040 INFO: --- Filter Status ---
2026-01-06 17:30:28,041 INFO:   FILTER_CONFIGS: All
2026-01-06 17:30:28,041 INFO:   FILTER_NEURONS: All
2026-01-06 17:30:28,041 INFO:   FILTER_ELECTRODES: All
2026-01-06 17:30:28,042 INFO:   FILTER_CURRENTS: All
2026-01-06 17:30:28,043 INFO: trials_df head:
   session  trial  config  electrode  current  trial_start_time  stim_time  \
0        0      0       1          0        3              2811       2811   
1        0      1       1          0        3              3807       3807   
2        0      2       1          0        3              4181       4181   
3        0      3       1          0        3              6609       6609   
4        0      4       1          0        3              8787       8787   
5        0      5       1          0        3             11589      11589   
6        0      6       1          0        3             12647      12647   
7        0      7       1          0        3             12772      12772   
8        0      0       2          0        4              1130       1130   
9        0      1       2          0        4              6173       6173   

   start_time  is_stim  
0        2811     True  
1        3807     True  
2        4181     True  
3        6609     True  
4        8787     True  
5       11589     True  
6       12647     True  
7       12772     True  
8        1130     True  
9        6173     True  
2026-01-06 17:30:28,044 INFO: --- Example queries ---
2026-01-06 17:30:28,044 INFO: Electrode 9, Current 5: 24 trials
2026-01-06 17:30:28,045 INFO: Session 0, Config 7: 8 trials
2026-01-06 17:30:29,054 INFO: Snippets DataFrame shape: (46653, 18)
2026-01-06 17:30:29,055 INFO: Valid snippets: 46653
2026-01-06 17:30:29,055 INFO: Snippets with stim at t=0: 720
2026-01-06 17:30:29,067 INFO: Holdout stim times per session: {np.int64(0): 31, np.int64(1): 31, np.int64(2): 31}
2026-01-06 17:30:29,838 INFO: Trial holdout [7]: train=32265, val=5694, test=8694
2026-01-06 17:30:29,838 INFO: === Split Summary (trial) ===
2026-01-06 17:30:29,839 INFO: Train: 32265 samples (69.2%)
2026-01-06 17:30:29,840 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-06 17:30:29,841 INFO: Val: 5694 samples (12.2%)
2026-01-06 17:30:29,841 INFO: Test: 8694 samples (18.6%)
2026-01-06 17:30:29,842 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-06 17:30:30,255 INFO: Batch size: 4
2026-01-06 17:30:30,255 INFO: Split strategy: trial
2026-01-06 17:30:31,396 INFO: Dataset sizes -> train: 32265, val: 5694, test: 8694
2026-01-06 17:30:31,397 INFO: Target neurons: [31] (indices: [30])
2026-01-06 17:30:31,403 INFO: Model architecture:
RNNModel(
  (initial_state_projection): Linear(in_features=110, out_features=32, bias=True)
  (rnn): GRU(10, 32, batch_first=True)
  (dense): Sequential(
    (0): Linear(in_features=32, out_features=1, bias=True)
  )
)
2026-01-06 17:30:31,403 INFO: Train input size: 10
2026-01-06 17:30:31,403 INFO: Initial condition size: 110 (FILTER_NEURONS)
2026-01-06 17:30:31,404 INFO: Train output size: 1 (TARGET_NEURONS)
2026-01-06 17:30:31,405 INFO: Hidden state size: 32
2026-01-06 17:30:31,405 INFO: Number of GRU layers: 1
2026-01-06 17:30:31,407 INFO: Learning rate 0.001
2026-01-06 17:30:31,407 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    decoupled_weight_decay: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)
2026-01-06 17:30:31,408 INFO: Loss type: mse
2026-01-06 17:30:31,408 INFO: Regularization coefficient: 0
2026-01-06 17:33:25,315 INFO: Epoch 1 Train loss: 0.010089022165281831
2026-01-06 17:33:36,431 INFO: Epoch 1 Validation loss: 0.008846749249576846
2026-01-06 17:33:36,436 INFO:   Saved best model with val loss 0.008847 to rnn_training/20260106_173027/best_model.pth
2026-01-06 17:36:28,975 INFO: Epoch 2 Train loss: 0.008508697508170557
2026-01-06 17:36:40,179 INFO: Epoch 2 Validation loss: 0.008578091280889466
2026-01-06 17:36:40,184 INFO:   Saved best model with val loss 0.008578 to rnn_training/20260106_173027/best_model.pth
2026-01-06 17:39:32,724 INFO: Epoch 3 Train loss: 0.008186348708587218
2026-01-06 17:39:43,655 INFO: Epoch 3 Validation loss: 0.008296571593125808
2026-01-06 17:39:43,660 INFO:   Saved best model with val loss 0.008297 to rnn_training/20260106_173027/best_model.pth
2026-01-06 17:42:35,642 INFO: Epoch 4 Train loss: 0.007930789875911799
2026-01-06 17:42:46,493 INFO: Epoch 4 Validation loss: 0.008415146045392353
2026-01-06 17:45:37,596 INFO: Epoch 5 Train loss: 0.0076773661657762
2026-01-06 17:45:48,386 INFO: Epoch 5 Validation loss: 0.008044457945169264
2026-01-06 17:45:48,390 INFO:   Saved best model with val loss 0.008044 to rnn_training/20260106_173027/best_model.pth
2026-01-06 17:48:39,680 INFO: Epoch 6 Train loss: 0.007444147982663613
2026-01-06 17:48:50,473 INFO: Epoch 6 Validation loss: 0.007553120397314597
2026-01-06 17:48:50,477 INFO:   Saved best model with val loss 0.007553 to rnn_training/20260106_173027/best_model.pth
2026-01-06 17:51:41,016 INFO: Epoch 7 Train loss: 0.0071857635193750755
2026-01-06 17:51:51,075 INFO: Epoch 7 Validation loss: 0.0074045400189685275
2026-01-06 17:51:51,079 INFO:   Saved best model with val loss 0.007405 to rnn_training/20260106_173027/best_model.pth
2026-01-06 17:54:35,978 INFO: Epoch 8 Train loss: 0.006949976260249076
2026-01-06 17:54:46,184 INFO: Epoch 8 Validation loss: 0.007216259462020907
2026-01-06 17:54:46,188 INFO:   Saved best model with val loss 0.007216 to rnn_training/20260106_173027/best_model.pth
2026-01-06 17:57:30,435 INFO: Epoch 9 Train loss: 0.006751291144133542
2026-01-06 17:57:40,609 INFO: Epoch 9 Validation loss: 0.007164064605373916
2026-01-06 17:57:40,613 INFO:   Saved best model with val loss 0.007164 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:00:25,390 INFO: Epoch 10 Train loss: 0.006525448474442182
2026-01-06 18:00:35,645 INFO: Epoch 10 Validation loss: 0.006909387829295786
2026-01-06 18:00:35,650 INFO:   Saved best model with val loss 0.006909 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:03:24,626 INFO: Epoch 11 Train loss: 0.006344080867680786
2026-01-06 18:03:34,898 INFO: Epoch 11 Validation loss: 0.006904303107520583
2026-01-06 18:03:34,902 INFO:   Saved best model with val loss 0.006904 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:06:19,251 INFO: Epoch 12 Train loss: 0.006166733235124237
2026-01-06 18:06:29,623 INFO: Epoch 12 Validation loss: 0.0068562659565006056
2026-01-06 18:06:29,626 INFO:   Saved best model with val loss 0.006856 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:09:29,063 INFO: Epoch 13 Train loss: 0.005979650947092859
2026-01-06 18:09:39,469 INFO: Epoch 13 Validation loss: 0.006474213481088757
2026-01-06 18:09:39,474 INFO:   Saved best model with val loss 0.006474 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:12:29,294 INFO: Epoch 14 Train loss: 0.005824077312511131
2026-01-06 18:12:39,554 INFO: Epoch 14 Validation loss: 0.006339348661757464
2026-01-06 18:12:39,559 INFO:   Saved best model with val loss 0.006339 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:15:30,750 INFO: Epoch 15 Train loss: 0.0056668071506503674
2026-01-06 18:15:40,733 INFO: Epoch 15 Validation loss: 0.006170911589064277
2026-01-06 18:15:40,737 INFO:   Saved best model with val loss 0.006171 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:18:32,744 INFO: Epoch 16 Train loss: 0.00550437119161468
2026-01-06 18:18:43,013 INFO: Epoch 16 Validation loss: 0.006319107464326576
2026-01-06 18:21:35,700 INFO: Epoch 17 Train loss: 0.005368111733700482
2026-01-06 18:21:45,843 INFO: Epoch 17 Validation loss: 0.00585724500091017
2026-01-06 18:21:45,847 INFO:   Saved best model with val loss 0.005857 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:24:39,556 INFO: Epoch 18 Train loss: 0.005233649999006033
2026-01-06 18:24:49,611 INFO: Epoch 18 Validation loss: 0.00578306582525718
2026-01-06 18:24:49,616 INFO:   Saved best model with val loss 0.005783 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:27:42,185 INFO: Epoch 19 Train loss: 0.005043492461827478
2026-01-06 18:27:52,478 INFO: Epoch 19 Validation loss: 0.0057632818295184325
2026-01-06 18:27:52,483 INFO:   Saved best model with val loss 0.005763 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:30:45,169 INFO: Epoch 20 Train loss: 0.0049594339526965745
2026-01-06 18:30:55,312 INFO: Epoch 20 Validation loss: 0.0058650483017768365
2026-01-06 18:33:39,611 INFO: Epoch 21 Train loss: 0.004806358416505734
2026-01-06 18:33:49,955 INFO: Epoch 21 Validation loss: 0.005451776742759188
2026-01-06 18:33:49,959 INFO:   Saved best model with val loss 0.005452 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:36:32,927 INFO: Epoch 22 Train loss: 0.004693300935581059
2026-01-06 18:36:43,071 INFO: Epoch 22 Validation loss: 0.00542989051284175
2026-01-06 18:36:43,075 INFO:   Saved best model with val loss 0.005430 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:39:25,696 INFO: Epoch 23 Train loss: 0.004590739196847028
2026-01-06 18:39:35,636 INFO: Epoch 23 Validation loss: 0.005194860475525799
2026-01-06 18:39:35,640 INFO:   Saved best model with val loss 0.005195 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:42:17,278 INFO: Epoch 24 Train loss: 0.004470362410575092
2026-01-06 18:42:27,335 INFO: Epoch 24 Validation loss: 0.005217177438699193
2026-01-06 18:45:09,146 INFO: Epoch 25 Train loss: 0.004402165088266268
2026-01-06 18:45:18,986 INFO: Epoch 25 Validation loss: 0.0052162313852315255
2026-01-06 18:48:00,788 INFO: Epoch 26 Train loss: 0.004363617929132064
2026-01-06 18:48:10,621 INFO: Epoch 26 Validation loss: 0.0050022616366812295
2026-01-06 18:48:10,626 INFO:   Saved best model with val loss 0.005002 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:50:52,697 INFO: Epoch 27 Train loss: 0.004263071560135058
2026-01-06 18:51:02,816 INFO: Epoch 27 Validation loss: 0.005009916165881552
2026-01-06 18:53:44,646 INFO: Epoch 28 Train loss: 0.004209359626275052
2026-01-06 18:53:54,487 INFO: Epoch 28 Validation loss: 0.004884009400639757
2026-01-06 18:53:54,491 INFO:   Saved best model with val loss 0.004884 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:56:36,618 INFO: Epoch 29 Train loss: 0.0041894790094360815
2026-01-06 18:56:46,645 INFO: Epoch 29 Validation loss: 0.005003678015572934
2026-01-06 18:59:28,786 INFO: Epoch 30 Train loss: 0.004102434014483557
2026-01-06 18:59:38,580 INFO: Epoch 30 Validation loss: 0.004854691080084319
2026-01-06 18:59:38,584 INFO:   Saved best model with val loss 0.004855 to rnn_training/20260106_173027/best_model.pth
2026-01-06 18:59:54,989 INFO: Test Loss: 0.009768
2026-01-06 19:00:16,053 INFO: Config 1 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:16,341 INFO: Config 2 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:16,608 INFO: Config 3 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:16,881 INFO: Config 4 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:17,185 INFO: Config 5 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:17,455 INFO: Config 6 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:17,920 INFO: Config 7 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:18,187 INFO: Config 8 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:18,461 INFO: Config 9 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:18,741 INFO: Config 10 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:19,018 INFO: Config 11 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:19,295 INFO: Config 12 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:19,575 INFO: Config 13 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:19,855 INFO: Config 14 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:20,135 INFO: Config 15 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:20,416 INFO: Config 16 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:20,699 INFO: Config 17 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:20,982 INFO: Config 18 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:21,262 INFO: Config 19 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:21,543 INFO: Config 20 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:21,826 INFO: Config 21 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:22,111 INFO: Config 22 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:22,531 INFO: Config 23 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:22,816 INFO: Config 24 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:23,100 INFO: Config 25 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:23,385 INFO: Config 26 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:23,668 INFO: Config 27 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:23,944 INFO: Config 28 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:24,221 INFO: Config 29 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:24,491 INFO: Config 30 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:24,764 INFO: Config 31 has 0 matching snippets (stim at t=0), neurons: [31]
2026-01-06 19:00:24,764 INFO: No matching snippets for config 31 with stim at offset 0, skipping.
2026-01-06 20:55:49,180 INFO: Test Loss: 0.009768
2026-01-06 20:59:54,516 INFO: Config 1 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:54,809 INFO: Config 2 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:55,095 INFO: Config 3 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:55,504 INFO: Config 4 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:55,911 INFO: Config 5 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:56,210 INFO: Config 6 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:56,480 INFO: Config 7 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:56,767 INFO: Config 8 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:57,072 INFO: Config 9 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:57,345 INFO: Config 10 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:57,652 INFO: Config 11 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:57,931 INFO: Config 12 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:58,242 INFO: Config 13 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:58,558 INFO: Config 14 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:59,056 INFO: Config 15 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:59,339 INFO: Config 16 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:59,623 INFO: Config 17 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 20:59:59,910 INFO: Config 18 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:00,218 INFO: Config 19 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:00,505 INFO: Config 20 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:00,807 INFO: Config 21 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:01,091 INFO: Config 22 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:01,378 INFO: Config 23 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:01,736 INFO: Config 24 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:02,023 INFO: Config 25 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:02,304 INFO: Config 26 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:02,588 INFO: Config 27 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:03,110 INFO: Config 28 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:03,543 INFO: Config 29 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:03,836 INFO: Config 30 has 24 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:04,117 INFO: Config 31 has 0 matching snippets (stim at t=0), neurons: [31]
2026-01-06 21:00:04,117 INFO: No matching snippets for config 31 with stim at offset 0, skipping.
2026-01-06 21:55:40,569 INFO: ROI 31: avg correlation = 0.0348 (n=10 samples)
2026-01-06 21:55:40,926 INFO: ROI 31: avg correlation = 0.0994 (n=10 samples)
2026-01-06 21:55:41,278 INFO: ROI 31: avg correlation = 0.2972 (n=10 samples)
2026-01-06 21:55:41,627 INFO: ROI 31: avg correlation = 0.0167 (n=10 samples)
2026-01-06 21:55:42,117 INFO: ROI 31: avg correlation = 0.4009 (n=10 samples)
2026-01-06 21:55:42,476 INFO: ROI 31: avg correlation = 0.2686 (n=10 samples)
2026-01-06 21:55:42,835 INFO: ROI 31: avg correlation = -0.0476 (n=10 samples)
2026-01-06 21:55:43,206 INFO: ROI 31: avg correlation = 0.4388 (n=10 samples)
2026-01-06 21:55:43,206 INFO: Overall avg correlation across all good pairs: 0.1886 (n=80 samples)
2026-01-06 21:57:54,845 INFO: ROI 31: avg correlation = 0.3110 (n=80 samples across all good_pairs)
2026-01-06 21:57:54,846 INFO: Overall avg correlation across all good pairs: 0.3110 (n=80 samples)
2026-01-06 22:01:49,635 INFO: ROI 31: avg correlation = 0.3255 (n=80 samples across all good_pairs)
2026-01-06 22:01:49,636 INFO: Overall avg correlation across all good pairs: 0.3255 (n=80 samples)
