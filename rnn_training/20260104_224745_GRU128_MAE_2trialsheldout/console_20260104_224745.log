2026-01-04 22:47:48,964 INFO: Logging started. Output file: rnn_training/20260104_224745/console_20260104_224745.log
2026-01-04 22:47:48,965 INFO: Seed: 42
2026-01-04 22:47:54,503 INFO: Iniitial conds fshape: (46713, 110)
2026-01-04 22:47:54,504 INFO: Activity snippets shape: (46713, 30, 110)
2026-01-04 22:47:54,504 INFO: Stim snippets shape: (46713, 30, 10)
2026-01-04 22:47:54,504 INFO: Snippet overlap: True
2026-01-04 22:47:56,754 INFO: Snippets DataFrame shape: (46713, 18)
2026-01-04 22:47:56,755 INFO: Valid snippets: 46713
2026-01-04 22:47:56,755 INFO: Snippets with stim at t=0: 720
2026-01-04 22:47:56,816 INFO: Trial holdout [1, 8]: train=37411, val=6602, test=2700
2026-01-04 22:47:58,516 INFO: Removed 3928 train snippets overlapping with test
2026-01-04 22:48:00,712 INFO: Removed 33483 train snippets overlapping with val
2026-01-04 22:48:01,007 INFO: Removed 671 val snippets overlapping with test
2026-01-04 22:48:01,009 INFO: === Split Summary (trial) after removing overlaps ===
2026-01-04 22:48:01,009 INFO: Train: 0 samples
2026-01-04 22:48:01,010 INFO:   Sessions: []
2026-01-04 22:48:01,010 INFO:   First configs with stim_at_t0: []
2026-01-04 22:48:01,011 INFO: Val: 5931 samples
2026-01-04 22:48:01,011 INFO: Test: 2700 samples
2026-01-04 22:48:01,012 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-04 22:48:01,098 INFO: Batch size: 8
2026-01-04 22:48:01,098 INFO: Split strategy: trial
2026-01-04 22:48:27,269 INFO: Iniitial conds fshape: (46713, 110)
2026-01-04 22:48:27,269 INFO: Activity snippets shape: (46713, 30, 110)
2026-01-04 22:48:27,270 INFO: Stim snippets shape: (46713, 30, 10)
2026-01-04 22:48:27,270 INFO: Snippet overlap: True
2026-01-04 22:48:31,642 INFO: Snippets DataFrame shape: (46713, 18)
2026-01-04 22:48:31,643 INFO: Valid snippets: 46713
2026-01-04 22:48:31,644 INFO: Snippets with stim at t=0: 720
2026-01-04 22:48:31,700 INFO: Trial holdout [1, 8]: train=37411, val=6602, test=2700
2026-01-04 22:48:33,335 INFO: Removed 3928 train snippets overlapping with test
2026-01-04 22:48:35,582 INFO: Removed 33483 train snippets overlapping with val
2026-01-04 22:48:35,875 INFO: Removed 671 val snippets overlapping with test
2026-01-04 22:48:35,877 INFO: === Split Summary (trial) after removing overlaps ===
2026-01-04 22:48:35,878 INFO: Train: 0 samples
2026-01-04 22:48:35,878 INFO:   Sessions: []
2026-01-04 22:48:35,879 INFO:   First configs with stim_at_t0: []
2026-01-04 22:48:35,879 INFO: Val: 5931 samples
2026-01-04 22:48:35,880 INFO: Test: 2700 samples
2026-01-04 22:48:35,880 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-04 22:50:01,962 INFO: Snippets DataFrame shape: (46713, 18)
2026-01-04 22:50:01,964 INFO: Valid snippets: 46713
2026-01-04 22:50:01,964 INFO: Snippets with stim at t=0: 720
2026-01-04 22:50:02,018 INFO: Trial holdout [1, 7]: train=35116, val=6197, test=5400
2026-01-04 22:50:04,580 INFO: Removed 7191 train snippets overlapping with test
2026-01-04 22:50:06,336 INFO: Removed 27925 train snippets overlapping with val
2026-01-04 22:50:06,792 INFO: Removed 1314 val snippets overlapping with test
2026-01-04 22:50:06,794 INFO: === Split Summary (trial) after removing overlaps ===
2026-01-04 22:50:06,794 INFO: Train: 0 samples
2026-01-04 22:50:06,795 INFO:   Sessions: []
2026-01-04 22:50:06,796 INFO:   First configs with stim_at_t0: []
2026-01-04 22:50:06,796 INFO: Val: 4883 samples
2026-01-04 22:50:06,796 INFO: Test: 5400 samples
2026-01-04 22:50:06,797 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-04 22:50:09,355 INFO: Batch size: 8
2026-01-04 22:50:09,355 INFO: Split strategy: trial
2026-01-04 22:50:29,090 INFO: Batch size: 8
2026-01-04 22:50:29,091 INFO: Split strategy: trial
2026-01-04 22:50:45,696 INFO: Batch size: 8
2026-01-04 22:50:45,697 INFO: Split strategy: trial
2026-01-04 22:57:30,958 INFO: Snippets DataFrame shape: (46713, 18)
2026-01-04 22:57:30,960 INFO: Valid snippets: 46713
2026-01-04 22:57:30,960 INFO: Snippets with stim at t=0: 720
2026-01-04 22:57:31,018 INFO: Trial holdout [1, 7]: train=35116, val=6197, test=5400
2026-01-04 22:57:33,592 INFO: Removed 7191 train snippets overlapping with test
2026-01-04 22:57:35,353 INFO: Removed 27925 train snippets overlapping with val
2026-01-04 22:57:35,817 INFO: Removed 1314 val snippets overlapping with test
2026-01-04 22:57:35,819 INFO: === Split Summary (trial) after removing overlaps ===
2026-01-04 22:57:35,820 INFO: Train: 0 samples
2026-01-04 22:57:35,820 INFO:   Sessions: []
2026-01-04 22:57:35,821 INFO:   First configs with stim_at_t0: []
2026-01-04 22:57:35,821 INFO: Val: 4883 samples
2026-01-04 22:57:35,822 INFO: Test: 5400 samples
2026-01-04 22:57:35,822 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-04 23:10:27,925 INFO: Snippets DataFrame shape: (46713, 18)
2026-01-04 23:10:27,928 INFO: Valid snippets: 46713
2026-01-04 23:10:27,928 INFO: Snippets with stim at t=0: 720
2026-01-04 23:10:27,970 INFO: Trial holdout [1, 7]: train=35116, val=6197, test=5400
2026-01-04 23:10:30,523 INFO: Removed 12037 train snippets overlapping with test
2026-01-04 23:10:31,972 INFO: Removed 23079 train snippets overlapping with val
2026-01-04 23:10:32,423 INFO: Removed 2141 val snippets overlapping with test
2026-01-04 23:10:32,425 INFO: === Split Summary (trial) after removing overlaps ===
2026-01-04 23:10:32,425 INFO: Train: 0 samples
2026-01-04 23:10:32,426 INFO:   Sessions: []
2026-01-04 23:10:32,427 INFO:   First configs with stim_at_t0: []
2026-01-04 23:10:32,427 INFO: Val: 4056 samples
2026-01-04 23:10:32,427 INFO: Test: 5400 samples
2026-01-04 23:10:32,428 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-04 23:13:29,536 INFO: Snippets DataFrame shape: (46713, 18)
2026-01-04 23:13:29,537 INFO: Valid snippets: 46713
2026-01-04 23:13:29,538 INFO: Snippets with stim at t=0: 720
2026-01-04 23:13:29,603 INFO: Trial holdout [1, 7]: train=35116, val=6197, test=5400
2026-01-04 23:13:29,606 INFO: Holdout stim times per session: {np.int64(0): 62, np.int64(1): 62, np.int64(2): 62}
2026-01-04 23:13:30,369 INFO: Removed 7537 train snippets near holdout stim times
2026-01-04 23:13:30,499 INFO: Removed 1370 val snippets near holdout stim times
2026-01-04 23:13:30,501 INFO: === Split Summary (trial) after removing overlaps ===
2026-01-04 23:13:30,501 INFO: Train: 27579 samples
2026-01-04 23:13:30,502 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-04 23:13:30,503 INFO:   First configs with stim_at_t0: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30)]
2026-01-04 23:13:30,503 INFO: Val: 4827 samples
2026-01-04 23:13:30,504 INFO: Test: 5400 samples
2026-01-04 23:13:30,504 INFO:   Sessions: [np.int64(0), np.int64(1), np.int64(2)]
2026-01-04 23:15:25,142 INFO: Batch size: 8
2026-01-04 23:15:25,143 INFO: Split strategy: trial
2026-01-04 23:15:25,762 INFO: Dataset sizes -> train: 27579, val: 4827, test: 5400
2026-01-04 23:15:25,763 INFO: Train input size: 10
2026-01-04 23:15:25,763 INFO: Train output size: 110
2026-01-04 23:15:25,764 INFO: Hidden state size: 128
2026-01-04 23:15:25,764 INFO: Number of GRU layers: 1
2026-01-04 23:15:25,775 INFO: Model architecture:\nRNNModel(
  (initial_state_projection): Linear(in_features=110, out_features=128, bias=True)
  (rnn): GRU(10, 128, batch_first=True)
  (dense): Sequential(
    (0): Linear(in_features=128, out_features=256, bias=True)
    (1): GELU(approximate='none')
    (2): Linear(in_features=256, out_features=110, bias=True)
  )
)
2026-01-04 23:15:25,777 INFO: Learning rate 0.0005
2026-01-04 23:15:25,777 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    decoupled_weight_decay: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)
2026-01-04 23:15:25,777 INFO: Loss type: mae
2026-01-04 23:15:25,778 INFO: Regularization coefficient: 0
2026-01-04 23:16:33,979 INFO: Epoch 1 Train loss: 0.0754095505227521
2026-01-04 23:16:37,501 INFO: Epoch 1 Validation loss: 0.07234056333324196
2026-01-04 23:16:37,506 INFO:   Saved best model with val loss 0.072341 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:17:41,859 INFO: Epoch 2 Train loss: 0.06964286589370498
2026-01-04 23:17:45,219 INFO: Epoch 2 Validation loss: 0.06746563355137232
2026-01-04 23:17:45,224 INFO:   Saved best model with val loss 0.067466 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:18:48,551 INFO: Epoch 3 Train loss: 0.0667431763149729
2026-01-04 23:18:52,078 INFO: Epoch 3 Validation loss: 0.06575305908470759
2026-01-04 23:18:52,083 INFO:   Saved best model with val loss 0.065753 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:19:55,381 INFO: Epoch 4 Train loss: 0.06570766159821625
2026-01-04 23:19:58,838 INFO: Epoch 4 Validation loss: 0.06513205022298947
2026-01-04 23:19:58,842 INFO:   Saved best model with val loss 0.065132 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:21:02,129 INFO: Epoch 5 Train loss: 0.06508181032793331
2026-01-04 23:21:05,570 INFO: Epoch 5 Validation loss: 0.06454267951628795
2026-01-04 23:21:05,575 INFO:   Saved best model with val loss 0.064543 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:22:08,855 INFO: Epoch 6 Train loss: 0.06445492009608211
2026-01-04 23:22:12,286 INFO: Epoch 6 Validation loss: 0.06398332559046153
2026-01-04 23:22:12,291 INFO:   Saved best model with val loss 0.063983 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:23:15,292 INFO: Epoch 7 Train loss: 0.06400264702177302
2026-01-04 23:23:18,745 INFO: Epoch 7 Validation loss: 0.06368788840414724
2026-01-04 23:23:18,749 INFO:   Saved best model with val loss 0.063688 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:24:21,677 INFO: Epoch 8 Train loss: 0.06370803476306032
2026-01-04 23:24:25,087 INFO: Epoch 8 Validation loss: 0.0632591770951462
2026-01-04 23:24:25,092 INFO:   Saved best model with val loss 0.063259 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:25:27,896 INFO: Epoch 9 Train loss: 0.06322957955873805
2026-01-04 23:25:31,257 INFO: Epoch 9 Validation loss: 0.06281698675124275
2026-01-04 23:25:31,261 INFO:   Saved best model with val loss 0.062817 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:26:33,618 INFO: Epoch 10 Train loss: 0.06288099175502714
2026-01-04 23:26:36,965 INFO: Epoch 10 Validation loss: 0.06258945267007715
2026-01-04 23:26:36,969 INFO:   Saved best model with val loss 0.062589 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:27:39,414 INFO: Epoch 11 Train loss: 0.06247391351062533
2026-01-04 23:27:42,908 INFO: Epoch 11 Validation loss: 0.06219122226974943
2026-01-04 23:27:42,912 INFO:   Saved best model with val loss 0.062191 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:28:45,604 INFO: Epoch 12 Train loss: 0.062237143397132405
2026-01-04 23:28:48,935 INFO: Epoch 12 Validation loss: 0.06199067780720612
2026-01-04 23:28:48,939 INFO:   Saved best model with val loss 0.061991 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:29:51,719 INFO: Epoch 13 Train loss: 0.062009671085341125
2026-01-04 23:29:55,009 INFO: Epoch 13 Validation loss: 0.06175932702296808
2026-01-04 23:29:55,013 INFO:   Saved best model with val loss 0.061759 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:30:57,644 INFO: Epoch 14 Train loss: 0.0617944327446772
2026-01-04 23:31:01,008 INFO: Epoch 14 Validation loss: 0.06157250582912533
2026-01-04 23:31:01,013 INFO:   Saved best model with val loss 0.061573 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:32:03,621 INFO: Epoch 15 Train loss: 0.061593422988823615
2026-01-04 23:32:07,010 INFO: Epoch 15 Validation loss: 0.06142542190712408
2026-01-04 23:32:07,014 INFO:   Saved best model with val loss 0.061425 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:33:09,886 INFO: Epoch 16 Train loss: 0.061420192110961655
2026-01-04 23:33:13,204 INFO: Epoch 16 Validation loss: 0.06126058154982737
2026-01-04 23:33:13,208 INFO:   Saved best model with val loss 0.061261 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:34:16,029 INFO: Epoch 17 Train loss: 0.06120932156207179
2026-01-04 23:34:19,473 INFO: Epoch 17 Validation loss: 0.06096788745829598
2026-01-04 23:34:19,478 INFO:   Saved best model with val loss 0.060968 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:35:22,524 INFO: Epoch 18 Train loss: 0.060905140991604975
2026-01-04 23:35:25,871 INFO: Epoch 18 Validation loss: 0.060658746693219266
2026-01-04 23:35:25,875 INFO:   Saved best model with val loss 0.060659 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:36:28,942 INFO: Epoch 19 Train loss: 0.060699764436388505
2026-01-04 23:36:32,325 INFO: Epoch 19 Validation loss: 0.06049320017924732
2026-01-04 23:36:32,330 INFO:   Saved best model with val loss 0.060493 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:37:34,999 INFO: Epoch 20 Train loss: 0.06052117782892355
2026-01-04 23:37:38,467 INFO: Epoch 20 Validation loss: 0.06039225171324578
2026-01-04 23:37:38,472 INFO:   Saved best model with val loss 0.060392 to rnn_training/20260104_224745/best_model.pth
2026-01-04 23:45:32,874 INFO: Test Loss: 0.064577
2026-01-05 10:11:46,329 INFO: Config 1 has 6 matching test snippets (stim at t=10), neurons: [7, 22, 26, 78]
2026-01-05 10:11:46,761 INFO: Config 2 has 6 matching test snippets (stim at t=10), neurons: [7, 22, 26, 78]
2026-01-05 10:11:47,218 INFO: Config 3 has 6 matching test snippets (stim at t=10), neurons: [7, 22, 26, 78]
2026-01-05 10:11:48,435 INFO: Config 4 has 6 matching test snippets (stim at t=10), neurons: [19, 47]
2026-01-05 10:11:48,621 INFO: Config 5 has 6 matching test snippets (stim at t=10), neurons: [19, 47]
2026-01-05 10:11:48,807 INFO: Config 6 has 6 matching test snippets (stim at t=10), neurons: [19, 47]
2026-01-05 10:11:49,009 INFO: Config 7 has 6 matching test snippets (stim at t=10), neurons: [7, 16, 26, 27, 31, 37, 59, 78]
2026-01-05 10:11:49,749 INFO: Config 8 has 6 matching test snippets (stim at t=10), neurons: [7, 16, 26, 27, 31, 37, 59, 78]
2026-01-05 10:11:50,510 INFO: Config 9 has 6 matching test snippets (stim at t=10), neurons: [7, 16, 26, 27, 31, 37, 59, 78]
2026-01-05 10:11:51,232 INFO: Config 10 has 6 matching test snippets (stim at t=10), neurons: [26]
2026-01-05 10:11:51,326 INFO: Config 11 has 6 matching test snippets (stim at t=10), neurons: [26]
2026-01-05 10:11:51,420 INFO: Config 12 has 6 matching test snippets (stim at t=10), neurons: [26]
2026-01-05 10:11:51,519 INFO: Config 13 has 6 matching test snippets (stim at t=10), neurons: [22, 23, 45, 63]
2026-01-05 10:11:51,892 INFO: Config 14 has 6 matching test snippets (stim at t=10), neurons: [22, 23, 45, 63]
2026-01-05 10:11:52,253 INFO: Config 15 has 6 matching test snippets (stim at t=10), neurons: [22, 23, 45, 63]
2026-01-05 10:11:52,627 INFO: Config 16 has 6 matching test snippets (stim at t=10), neurons: [50, 63]
2026-01-05 10:11:52,825 INFO: Config 17 has 6 matching test snippets (stim at t=10), neurons: [50, 63]
2026-01-05 10:11:53,086 INFO: Config 18 has 6 matching test snippets (stim at t=10), neurons: [50, 63]
2026-01-05 10:11:53,280 INFO: Config 19 has 6 matching test snippets (stim at t=10), neurons: [4, 19, 33, 44, 46]
2026-01-05 10:11:53,738 INFO: Config 20 has 6 matching test snippets (stim at t=10), neurons: [4, 19, 33, 44, 46]
2026-01-05 10:11:54,414 INFO: Config 21 has 6 matching test snippets (stim at t=10), neurons: [4, 19, 33, 44, 46]
2026-01-05 10:11:54,882 INFO: Config 22 has 6 matching test snippets (stim at t=10), neurons: [7, 21, 32, 37, 81]
2026-01-05 10:11:55,361 INFO: Config 23 has 6 matching test snippets (stim at t=10), neurons: [7, 21, 32, 37, 81]
2026-01-05 10:11:55,827 INFO: Config 24 has 6 matching test snippets (stim at t=10), neurons: [7, 21, 32, 37, 81]
2026-01-05 10:11:56,262 INFO: Config 25 has 6 matching test snippets (stim at t=10), neurons: [31, 44, 78]
2026-01-05 10:11:56,555 INFO: Config 26 has 6 matching test snippets (stim at t=10), neurons: [31, 44, 78]
2026-01-05 10:11:56,841 INFO: Config 27 has 6 matching test snippets (stim at t=10), neurons: [31, 44, 78]
2026-01-05 10:11:57,160 INFO: Config 28 has 6 matching test snippets (stim at t=10), neurons: [26, 27, 31, 100]
2026-01-05 10:11:57,524 INFO: Config 29 has 6 matching test snippets (stim at t=10), neurons: [26, 27, 31, 100]
2026-01-05 10:11:57,890 INFO: Config 30 has 6 matching test snippets (stim at t=10), neurons: [26, 27, 31, 100]
2026-01-05 10:11:58,241 INFO: Config 31 has 0 matching test snippets (stim at t=10), neurons: [1, 2, 3]
2026-01-05 10:11:58,242 INFO: No matching snippets for config 31 with stim at offset 10, skipping.
2026-01-05 12:12:57,125 INFO: Number of epochs 5
2026-01-05 12:12:57,314 INFO: configs shape: (3, 110, 31)
2026-01-05 12:12:57,315 INFO: roi_used shape: (512, 512)
2026-01-05 12:12:57,315 INFO: times shape: (3, 8, 31)
2026-01-05 12:12:57,316 INFO: dfof shape: (3, 15600, 110)
